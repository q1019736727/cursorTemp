@Entry
@Component
struct BottomSheetDemo {
  @State showSheet1: boolean = false
  @State showSheet2: boolean = false
  @State showSheet3: boolean = false

  build() {
    Column() {
      Text('é¸¿è’™åº•éƒ¨å¼¹çª—æ¼”ç¤º')
        .fontSize(28)
        .fontWeight(FontWeight.Bold)
        .margin({ top: 60, bottom: 40 })

      // ç¤ºä¾‹æŒ‰é’®
      Column({ space: 20 }) {
        Button('åŸºç¡€åº•éƒ¨å¼¹çª—')
          .width('80%')
          .height(50)
          .fontSize(16)
          .onClick(() => {
            this.showSheet1 = true
          })

        Button('å¸¦æ ‡é¢˜çš„å¼¹çª—')
          .width('80%')
          .height(50)
          .fontSize(16)
          .onClick(() => {
            this.showSheet2 = true
          })

        Button('è‡ªå®šä¹‰æ ·å¼å¼¹çª—')
          .width('80%')
          .height(50)
          .fontSize(16)
          .onClick(() => {
            this.showSheet3 = true
          })
      }
      .width('100%')

      Spacer()
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#f8f9fa')
    .bindSheet($$this.showSheet1, this.BasicSheetBuilder(), {
      height: 300,
      dragBar: true,
      showClose: false,
      backgroundColor: Color.White,
      onDisappear: () => {
        this.showSheet1 = false
      }
    })
    .bindSheet($$this.showSheet2, this.TitleSheetBuilder(), {
      height: 350,
      dragBar: false,
      showClose: true,
      backgroundColor: Color.White,
      onDisappear: () => {
        this.showSheet2 = false
      }
    })
    .bindSheet($$this.showSheet3, this.CustomSheetBuilder(), {
      height: 400,
      dragBar: true,
      showClose: false,
      backgroundColor: '#ffffff',
      onDisappear: () => {
        this.showSheet3 = false
      }
    })
  }

  @Builder
  BasicSheetBuilder() {
    Column() {
      // å†…å®¹åŒºåŸŸ
      Column({ space: 16 }) {
        Text('åŸºç¡€å¼¹çª—å†…å®¹')
          .fontSize(18)
          .fontWeight(FontWeight.Medium)
          .margin({ top: 20 })

        Text('è¿™æ˜¯ä¸€ä¸ªä»Žåº•éƒ¨å¼¹å‡ºçš„åŠå±å¼¹çª—ï¼Œé«˜åº¦ä¸º300pxï¼Œå·¦å³è´´ç€å±å¹•è¾¹ç¼˜ã€‚')
          .fontSize(14)
          .fontColor('#666666')
          .textAlign(TextAlign.Center)
          .margin({ left: 20, right: 20 })

        // æ“ä½œæŒ‰é’®
        Row({ space: 12 }) {
          Button('å–æ¶ˆ')
            .width(100)
            .height(40)
            .fontSize(14)
            .backgroundColor('#f0f0f0')
            .fontColor('#333333')
            .onClick(() => {
              this.showSheet1 = false
            })

          Button('ç¡®è®¤')
            .width(100)
            .height(40)
            .fontSize(14)
            .backgroundColor('#007AFF')
            .fontColor(Color.White)
            .onClick(() => {
              console.log('ç¡®è®¤æ“ä½œ')
              this.showSheet1 = false
            })
        }
        .margin({ top: 30 })
      }
      .width('100%')
      .flexGrow(1)
      .justifyContent(FlexAlign.Center)
    }
    .width('100%')
    .height('100%')
  }

  @Builder
  TitleSheetBuilder() {
    Column() {
      // æ ‡é¢˜æ 
      Row() {
        Text('é€‰æ‹©æ“ä½œ')
          .fontSize(20)
          .fontWeight(FontWeight.Bold)
        
        Spacer()
        
        Image($r('app.media.icon'))
          .width(24)
          .height(24)
          .onClick(() => {
            this.showSheet2 = false
          })
      }
      .width('100%')
      .padding({ left: 20, right: 20, top: 16, bottom: 16 })

      Divider()
        .color('#e0e0e0')

      // é€‰é¡¹åˆ—è¡¨
      Column() {
        this.OptionItem('æ‹ç…§', () => {
          console.log('é€‰æ‹©æ‹ç…§')
          this.showSheet2 = false
        })

        Divider().color('#f0f0f0').margin({ left: 20, right: 20 })

        this.OptionItem('ä»Žç›¸å†Œé€‰æ‹©', () => {
          console.log('é€‰æ‹©ç›¸å†Œ')
          this.showSheet2 = false
        })

        Divider().color('#f0f0f0').margin({ left: 20, right: 20 })

        this.OptionItem('æ–‡ä»¶ç®¡ç†å™¨', () => {
          console.log('é€‰æ‹©æ–‡ä»¶')
          this.showSheet2 = false
        })
      }
      .flexGrow(1)
    }
    .width('100%')
    .height('100%')
  }

  @Builder
  CustomSheetBuilder() {
    Column() {
      // è‡ªå®šä¹‰å†…å®¹
      Column({ space: 20 }) {
        // å›¾æ ‡å’Œæ ‡é¢˜
        Column({ space: 12 }) {
          Image($r('app.media.icon'))
            .width(48)
            .height(48)
          
          Text('è‡ªå®šä¹‰å¼¹çª—')
            .fontSize(22)
            .fontWeight(FontWeight.Bold)
          
          Text('è¿™æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰æ ·å¼çš„åº•éƒ¨å¼¹çª—ç¤ºä¾‹')
            .fontSize(14)
            .fontColor('#888888')
            .textAlign(TextAlign.Center)
        }
        .margin({ top: 30 })

        // åŠŸèƒ½åˆ—è¡¨
        Column({ space: 0 }) {
          this.FeatureItem('ðŸ ', 'é¦–é¡µ', 'è¿”å›žåº”ç”¨é¦–é¡µ')
          this.FeatureItem('âš™ï¸', 'è®¾ç½®', 'æ‰“å¼€åº”ç”¨è®¾ç½®')
          this.FeatureItem('ðŸ“ž', 'è”ç³»æˆ‘ä»¬', 'èŽ·å–æŠ€æœ¯æ”¯æŒ')
          this.FeatureItem('â„¹ï¸', 'å…³äºŽ', 'æŸ¥çœ‹åº”ç”¨ä¿¡æ¯')
        }
        .backgroundColor('#f8f9fa')
        .borderRadius(12)
        .margin({ left: 20, right: 20, top: 20 })

        // åº•éƒ¨æŒ‰é’®
        Button('å…³é—­')
          .width('90%')
          .height(48)
          .fontSize(16)
          .backgroundColor('#ff6b6b')
          .fontColor(Color.White)
          .borderRadius(24)
          .margin({ top: 20 })
          .onClick(() => {
            this.showSheet3 = false
          })
      }
      .width('100%')
      .flexGrow(1)
      .justifyContent(FlexAlign.Center)
    }
    .width('100%')
    .height('100%')
  }

  @Builder
  OptionItem(title: string, onTap: () => void) {
    Row() {
      Text(title)
        .fontSize(16)
        .fontColor('#333333')
      
      Spacer()
      
      Text('>')
        .fontSize(16)
        .fontColor('#cccccc')
    }
    .width('100%')
    .height(50)
    .padding({ left: 20, right: 20 })
    .onClick(onTap)
  }

  @Builder
  FeatureItem(icon: string, title: string, subtitle: string) {
    Row() {
      Text(icon)
        .fontSize(24)
        .margin({ right: 16 })
      
      Column({ space: 4 }) {
        Text(title)
          .fontSize(16)
          .fontWeight(FontWeight.Medium)
          .alignSelf(ItemAlign.Start)
        
        Text(subtitle)
          .fontSize(12)
          .fontColor('#888888')
          .alignSelf(ItemAlign.Start)
      }
      .alignItems(HorizontalAlign.Start)
      .flexGrow(1)
      
      Text('>')
        .fontSize(16)
        .fontColor('#cccccc')
    }
    .width('100%')
    .height(60)
    .padding({ left: 16, right: 16 })
    .onClick(() => {
      console.log(`ç‚¹å‡»äº†${title}`)
      this.showSheet3 = false
    })
  }
}